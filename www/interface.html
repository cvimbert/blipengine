<!DOCTYPE html>
<html>
    <head>
        <title>Model monitor</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="js/underscore.js" type="text/javascript"></script>
        <script src="js/jquery-1.11.2.js" type="text/javascript"></script>
        <script src="js/widgets.js" type="text/javascript"></script>
        <link href="js/bootstrap-3.3.5-dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/interface.css" rel="stylesheet" type="text/css"/>
        <script src="js/angular.min.js" type="text/javascript"></script>
        <script src="js/uuid.js" type="text/javascript"></script>
        <link href="js/bootstrap-combobox-master/css/bootstrap-combobox.css" rel="stylesheet" type="text/css"/>
        <script src="js/bootstrap-combobox-master/js/bootstrap-combobox.js" type="text/javascript"></script>
        <script src="js/bootstrap-3.3.5-dist/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="js/modelmonitor.js" type="text/javascript"></script>
        <script src="js/modeldescriptor_v3.js" type="text/javascript"></script>
        <script src="js/modelmanagerv2.js" type="text/javascript"></script>
    </head>

    <body ng-app="model-monitor" ng-controller="modelmonitorcontroller">
        <div class="container-fluid">

            <div id="monitor-container">
                <div class="row">
                    <div ng-repeat="(descid, desc) in completeDescriptor" ng-if="desc.referenceable" class="model-displayer-container col-md-3">
                        <div id="model-displayer-{{descid}}" class="model-displayer">
                            <span class="title">Créer {{descid}}</span>
                            <button ng-click="addElement(descid)" class="glyphicon-plus btn-add btn btn-default" type="submit"></button>
                            <div class="item-displayer-container">
                                <div ng-click="editElement(descid, item)" ng-repeat="item in completeModel[descid]" class="item-displayer">
                                    {{getName(item)}}
                                    <div ng-click="deleteItem(descid, item, $event)" class="item-delete-button">x</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="modal-desc" class="modal fade">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">Créer {{descid}}</h4>
                        </div>
                        <div class="modal-body">

                            <div class="modal-attribute-container" ng-repeat="(attributeid, attribute) in descriptor">
                                <div class="input-group monitor-modal-input-group indented-{{attribute.indentation}}">
                                    <span class="input-group-addon monitor-modal-input-group-addon" id="basic-addon">
                                        {{attributeid}}
                                    </span>

                                    <input ng-model="item[attributeid]" ng-if="attribute.type === 'string'" type="text" class="form-control" placeholder="Condition name" aria-describedby="basic-addon" value="">

                                    <input ng-model="item[attributeid]" ng-if="attribute.type === 'number'" type="number" class="form-control" placeholder="Condition name" aria-describedby="basic-addon" value="">

                                    <select ng-model="item[attributeid]" ng-if="attribute.type === 'boolean'" class="combobox">
                                        <option value="false">false</option>
                                        <option value="true">true</option>
                                    </select>

                                    <select ng-model="item[attributeid]" ng-change="attributeSetSelected()" ng-if="attribute.type === 'ConditionalAttributesSet'" class="combobox">
                                        <option></option>
                                        <option ng-repeat="(setid, set) in attribute.attributesSets" value="{{setid}}">{{setid}}</option> 
                                    </select>

                                    <select ng-model="item[attributeid]" ng-if="attribute.type === 'Enumeration'" class="combobox">
                                        <option></option>
                                        <option ng-repeat="val in attribute.enumerationvalues" value="{{val}}">{{val}}</option>
                                    </select>

                                    <div ng-if="attribute.type === 'reference'">
                                        <table>
                                            <tr>
                                                <td>
                                                    <select ng-model="item[attributeid]" class="combobox">
                                                        <option></option>
                                                        <option ng-repeat="(refid, ref) in getReferences(attribute.referencetype)" value="{{refid}}">{{getName(ref)}}</option>
                                                    </select>
                                                </td>
                                                <td class="button-td">
                                                    <button class="glyphicon-plus btn-add btn btn-default" type="submit"></button>
                                                </td>
                                                <td class="button-td">
                                                    <button class="glyphicon-plus btn-add btn btn-default" type="submit"></button>
                                                </td>
                                            </tr>
                                        </table>

                                        
                                        
                                    </div>    

                                </div>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
                            <button ng-click="validate()" type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer">
                <button ng-click="save()" type="button" class="btn btn-primary">Sauvegarder</button>
                <button ng-click="deleteModel()" type="button" class="btn btn-danger">Effacer le modèle</button>
            </div>
        </div>
    </body>
</html>
